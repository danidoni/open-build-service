- @pagetitle = "Token - #{@token.description.presence || 'No Description'}"

.card
  .card-body
    %h3.mb-3
      = @pagetitle

    .row
      .col-12.col-md-10.col-lg-8
        - if session[:show_token]
          %p.font-weight-bold Your new OBS Personal Access Token

        .form-row
          .col-sm
            %label.font-weight-bold
              Id:
            %span
              = @token.id

        .form-row
          .col-12.col-md-10.col-lg-9
            %fieldset.form-group
              %label.col-form-label.font-weight-bold
                Secret:
              .d-flex.flex-row
                #token-reveal
                  = button_tag('Reveal', class: 'btn btn-primary')
                .input-group.d-none#token-secret
                  = render CopyToClipboardInputComponent.new(input_text: @token.string, input_id: 'clipboard-for-secret')
                .d-none#token-hide
                  = button_tag('Hide', class: 'btn btn-primary ml-2')
            %hr

        .form-row
          .col
            .form-group
              %label.col-form-label.mr-2.font-weight-bold
                Type:
              %span
                = @token.token_name

        .form-row
          .col-sm
            .form-group.ui-front
              %label.font-weight-bold
                Runs as:
              %span
                = link_to(@token.user.login, user_path(@token.user))

        - if @token.type == 'Token::Workflow'
          .form-row
            .col
              .form-group
                %label.col-form-label.mr-2.font-weight-bold
                  Token trigger url:
                .input-group
                  = render CopyToClipboardInputComponent.new(input_text: trigger_workflow_url(id: @token.id))

        - if @token.package
          .form-row
            .col-sm
              .form-group.ui-front
                %label.font-weight-bold
                  Project:
                %span
                  = link_to(@token.package.project.name, project_show_path(@token.package.project))

          .form-row
            .col-sm
              .form-group.ui-front
                %label.font-weight-bold
                  Package:
                %span
                  = link_to(@token.package.name, package_show_path(@token.package.project, @token.package))

        .actions
          - if policy(@token).edit?
            = link_to(edit_token_path(@token), class: 'pl-2', title: 'Edit') do
              %i.fas.fa-edit
              %span.nav-item-name Edit
          - if policy(@token).webui_trigger?
            = link_to(token_trigger_path(@token), class: 'pl-2', title: 'Trigger Token') do
              %i.fas.fa-project-diagram
              %span.nav-item-name Trigger Token
          - if @token.type == 'Token::Workflow'
            = link_to(token_users_path(@token.id), class: 'pl-2', title: 'Users') do
              %i.fas.fa-users
              %span.nav-item-name Users
            = link_to(token_workflow_runs_path(@token.id), class: 'pl-2', title: 'Workflow Runs') do
              %i.fas.fa-book-open
              %span.nav-item-name Workflow Runs

:javascript
  $(document).ready(function() {
    $('#token-reveal, #token-hide').on('click', function (event) {
      $(this).toggleClass('d-none');
      $('#token-hide').toggleClass('d-none');
      $('#token-secret').toggleClass('d-none');
    });
  });
